openapi: 3.0.0
info:
  title: polymorphic unmarshaller
  description: reproduces issue 1532
  version: 1.0.0
paths:
  /mytest:
    get:
      description: my test
      responses:
        "200":
          description: my test
components:
  schemas:
    Event:
      type: object
      discriminator:
        propertyName: event
      properties:
        event:
          type: string
          enum:
            - update_object
            - delete
        id:
          type: string
      required:
        - event
        - id
    update_object:
      type: object
      allOf:
        - $ref: "#/components/schemas/Event"
        - type: object
          properties:
            data:
              $ref: "#/components/schemas/Object"
    Object:
      type: object
      discriminator:
        propertyName: type
      properties:
        type:
          type: string
          enum:
            - Message
            - User
      required:
        - type
